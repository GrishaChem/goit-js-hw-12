{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/LoadMoreService.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export function renderGallery(gallery, images) {\n  const markUp = images\n    .map(\n      image =>\n        `\n      <a href=\"${image.largeImageURL}\" class=\"gallery-item\">\n        <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" />\n        <div class=\"info\">\n          <p>Likes: ${image.likes}</p>\n          <p>Views: ${image.views}</p>\n          <p>Comments: ${image.comments}</p>\n          <p>Downloads: ${image.downloads}</p>\n        </div>\n      </a>\n    `\n    )\n    .join('');\n\n  return gallery.insertAdjacentHTML('beforeend', markUp);\n}\n\nexport function clearGallery(gallery) {\n  gallery.innerHTML = '';\n}\n","export default class ButtonService {\n  constructor(buttonEl, hiddenClass) {\n    this.buttonEl = buttonEl;\n    this.hiddenClass = hiddenClass;\n  }\n  hide() {\n    this.buttonEl.classList.add(this.hiddenClass);\n  }\n  show() {\n    this.buttonEl.classList.remove(this.hiddenClass);\n  }\n  disable() {\n    this.buttonEl.disabled = true;\n  }\n  enable() {\n    this.buttonEl.disabled = false;\n  }\n}\n","// export function searchImages(query) {\nimport axios from 'axios';\nconst URL = 'https://pixabay.com/api/';\nconst API = '45254861-458f9554e62e34626fe81458f';\n\n// axios.defaults.baseURL = URL;\n\nfunction getImages({ page = 1, per_page = 15, q = '' } = {}) {\n  return axios\n    .get(URL, {\n      params: {\n        page,\n        per_page,\n        q,\n        key: API,\n      },\n    })\n    .then(({ data }) => data);\n}\n\nexport { getImages };\n\n//   return fetch(\n//     `${URL}?key=${API}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true`\n//   ).then(res => {\n//     if (!res.ok) {\n//       throw new Error(res.status);\n//     }\n//     return res.json();\n//   });\n// }\n","// import { searchImages } from './js/pixabay-api.js';\nimport { renderGallery, clearGallery } from './js/render-functions.js';\nimport ButtonService from './js/LoadMoreService.js';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\nimport * as ImagesApiService from './js/pixabay-api.js';\n\nconst gallery = document.querySelector('.gallery');\nconst submit = document.querySelector('#button');\nconst input = document.querySelector('#input');\nconst searchForm = document.querySelector('#search-form');\nconst loader = document.querySelector('.loader');\nconst loadBtn = document.querySelector('.btn');\n\nconsole.log(ImagesApiService);\nfunction showLoader() {\n  loader.classList.add('is-visible');\n}\n\nfunction hideLoader() {\n  loader.classList.remove('is-visible');\n}\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  /* options */\n});\n\n//* --- Load more btn\n\nconst loadMoreBtn = new ButtonService(loadBtn, 'is-hidden');\n\nloadMoreBtn.hide();\n\nconst params = {\n  page: 1,\n  per_page: 15,\n  q: '',\n  maxPage: 0,\n};\n\nsearchForm.addEventListener('submit', handleSubmit);\n\nasync function handleSubmit(event) {\n  event.preventDefault();\n  clearGallery(gallery);\n  params.q = input.value.trim();\n  console.log(params.q);\n  showLoader();\n\n  loadMoreBtn.show();\n  loadMoreBtn.disable();\n\n  params.page = 1;\n\n  try {\n    if (params.q == '') {\n      throw new Error();\n    }\n    const { hits, total } = await ImagesApiService.getImages(params);\n    params.maxPage = Math.ceil(total / params.per_page);\n    renderGallery(gallery, hits);\n    lightbox.refresh();\n    console.log(total);\n    const cardHeight = document\n      .querySelector('.gallery-item')\n      .getBoundingClientRect().height;\n    smoothScroll(cardHeight);\n    hideLoader();\n    if (params.maxPage > 1) {\n      loadMoreBtn.enable();\n      loadBtn.addEventListener('click', handleClick);\n    } else {\n      loadMoreBtn.hide();\n    }\n  } catch (err) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Error',\n    });\n    hideLoader();\n    loadMoreBtn.hide();\n    loadBtn.removeEventListener('click', handleClick);\n  } finally {\n    searchForm.reset();\n  }\n}\n\nasync function handleClick() {\n  loadMoreBtn.disable();\n  params.page += 1;\n\n  try {\n    const { hits } = await ImagesApiService.getImages(params);\n    renderGallery(gallery, hits);\n    hideLoader();\n    const cardHeight = document\n      .querySelector('.gallery-item')\n      .getBoundingClientRect().height;\n    smoothScroll(cardHeight);\n  } catch (err) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Error',\n    });\n  } finally {\n    if (params.page == params.maxPage) {\n      loadMoreBtn.hide();\n      loadBtn.removeEventListener('click', handleClick);\n      iziToast.info({\n        title: 'End',\n        message:\n          'We are sorry, but you have reached the end of search results.',\n      });\n    } else {\n      loadMoreBtn.enable();\n    }\n  }\n}\n\nfunction smoothScroll(cardHeight) {\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\n//   searchImages(params.q)\n//     .then(data => {\n//       console.log(data);\n//       if (data.hits.length === 0) {\n//         iziToast.error({\n//           title: 'Error',\n//           message:\n//             'Sorry, there are no images matching your search query. Please try again!',\n//         });\n//         clearGallery(gallery);\n//         hideLoader();\n//         return;\n//       }\n//       const images = data.hits;\n\n//       renderGallery(gallery, images);\n//       console.log(images);\n\n//       hideLoader();\n\n//       lightbox.refresh();\n//     })\n//     .catch(error => {\n//       console.log(error);\n//       hideLoader(); // Скрываем лоадер при ошибке\n//     });\n// }\n"],"names":["renderGallery","gallery","images","markUp","image","clearGallery","ButtonService","buttonEl","hiddenClass","URL","API","getImages","page","per_page","q","axios","data","input","searchForm","loader","loadBtn","ImagesApiService","showLoader","hideLoader","lightbox","SimpleLightbox","loadMoreBtn","params","handleSubmit","event","hits","total","ImagesApiService.getImages","cardHeight","smoothScroll","handleClick","iziToast"],"mappings":"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"}